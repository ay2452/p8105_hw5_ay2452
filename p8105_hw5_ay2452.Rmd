---
title: "p8105_hw5_ay2452"
author: "Alicia Yang"
date: "11/11/2019"
output: github_document
---

```{r setup}
library(tidyverse)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

```{r Problem 1}
iris_function = function(x) {
  if (is.numeric(x)) {
   replace_na(x, mean(x, na.rm = TRUE))
  }
  else if (is.character(x)) {
    replace_na(x, "virginia")
  }
}

output = vector("list", length = 5)

for (i in 1:5) {
  output[[i]] = iris_function(iris_with_missing[[i]])
}

output = map(iris_with_missing, iris_function)
```

```{r Problem 2}
Study_df = list.files(path = "./data",
             pattern = "*.csv", 
             full.names = TRUE) %>%
  map_dfr(read_csv, .id = "group") %>%
  mutate(
    group = recode(group, "1" = "control", "2" = "control", "3" = "control", "4" = "control", "5" = "control", "6" = "control", "7" = "control", "8" = "control", "9" = "control", "10" = "control", "11" = "experiment", "12" = "experiment", "13" = "experiment", "14" = "experiment", "15" = "experiment", "16" = "experiment", "17" = "experiment", "18" = "experiment", "19" = "experiment", "20" = "experiment" )) %>% 
  pivot_longer(
    week_1: week_8,
    names_to = "time", 
    values_to = "observations"
  )
```
